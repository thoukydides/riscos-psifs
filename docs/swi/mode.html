<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!-- File        : swi/mode.html -->
<!-- Date        : 19-Sep-02 -->
<!-- Description : Part of the PsiFS documentation. -->
<!-- -->
<!-- Copyright Â© 1998, 1999, 2000, 2001, 2002 Alexander Thoukydides -->
<!-- -->
<!-- This program is free software; you can redistribute it and/or -->
<!-- modify it under the terms of the GNU General Public License -->
<!-- as published by the Free Software Foundation; either version 2 -->
<!-- of the License, or (at your option) any later version. -->
<!-- -->
<!-- This program is distributed in the hope that it will be useful, -->
<!-- but WITHOUT ANY WARRANTY; without even the implied warranty of -->
<!-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the -->
<!-- GNU General Public License for more details. -->
<!-- -->
<!-- You should have received a copy of the GNU General Public License -->
<!-- along with this program; if not, write to the Free Software -->
<!-- Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA -->
<HTML>
<HEAD>
<TITLE>PsiFS Documentation - SWI Calls [PsiFS_Mode]</TITLE>
<LINK REV=MADE HREF="mailto:psifs@thouky.co.uk">
<LINK REL=PARENT HREF="index.html">
<META NAME=DESCRIPTION CONTENT="PsiFS Documentation - SWI Calls [PsiFS_Mode]">
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000FF" VLINK="#004499" ALINK="#FF0000">
<CENTER>
<H1><FONT COLOR="#004499"><B><I>PsiFS</I></B></FONT>: SWI Calls</H1>
<B>PsiFS_Mode</B> </CENTER>
<HR>
<TABLE WIDTH="100%"><TR><TD COLSPAN=4 ALIGN=RIGHT><FONT COLOR="#DD0000"><TT><B>PsiFS_Mode</B></TT><BR><TT>(SWI&nbsp;&amp;520C4)</TT></FONT></TD></TR><TR VALIGN=TOP><TD></TD><TD COLSPAN=3>Set the mode of operation</TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>On&nbsp;entry:</B></FONT></TD><TD>R0&nbsp;=</TD><TD COLSPAN=2>reason code</TD></TR>
<TR VALIGN=TOP><TD></TD><TD COLSPAN=3>Other registers depend on reason code</TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>On&nbsp;exit:</B></FONT></TD><TD COLSPAN=3>Registers preserved</TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>Interrupts:</B></FONT></TD><TD COLSPAN=3>Interrupt status is undefined<BR>Fast interrupts are enabled</TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>Processor&nbsp;mode:</B></FONT></TD><TD COLSPAN=3>Processor is in SVC mode</TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>Re-entrancy:</B></FONT></TD><TD COLSPAN=3>SWI is not re-entrant</TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>Use:</B></FONT></TD><TD COLSPAN=3>
This call changes <FONT COLOR="#004499"><B><I>PsiFS</I></B></FONT>'s mode of operation, depending on the reason code in R0. Valid reason codes are:
<TABLE BORDER=1 ALIGN=CENTER>
<TR><TH>Value</TH><TH>Meaning</TH></TR>
<TR VALIGN=TOP><TD ALIGN=CENTER>0</TD><TD>Inactive</TD></TR>
<TR VALIGN=TOP><TD ALIGN=CENTER>1</TD><TD>Remote link mode</TD></TR>
<TR VALIGN=TOP><TD ALIGN=CENTER>2</TD><TD>Printer mirror mode</TD></TR>
</TABLE>
<P>
These are described separately below.
</TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>Related&nbsp;SWIs:</B></FONT></TD><TD COLSPAN=3><TT><A HREF="set.html" TITLE="PsiFS_Set">PsiFS_Set</A></TT>, <TT><A HREF="get.html" TITLE="PsiFS_Get">PsiFS_Get</A></TT></TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>Related&nbsp;vectors:</B></FONT></TD><TD COLSPAN=3>None</TD></TR>
</TABLE>
<HR>
<TABLE WIDTH="100%"><TR><TD COLSPAN=4 ALIGN=RIGHT><FONT COLOR="#DD0000"><TT><B>PsiFS_Mode 0</B></TT><BR><TT>(SWI&nbsp;&amp;520C4)</TT></FONT></TD></TR><TR VALIGN=TOP><TD></TD><TD COLSPAN=3>Set <FONT COLOR="#004499"><B><I>PsiFS</I></B></FONT> to inactive mode</TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>On&nbsp;entry:</B></FONT></TD><TD>R0&nbsp;=</TD><TD COLSPAN=2>0</TD></TR>
<TR VALIGN=TOP><TD></TD><TD>R1&nbsp;=</TD><TD COLSPAN=2>non-zero to disconnect immediately</TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>On&nbsp;exit:</B></FONT></TD><TD COLSPAN=3>Registers preserved</TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>Use:</B></FONT></TD><TD COLSPAN=3>
This call closes any active connection and ends use of the configured block driver. This allows other programs to use the serial port. It is equivalent to using <TT>*<A HREF="../command/disbl.html" TITLE="*PsiFSDisable">PsiFSDisable</A></TT>.
<P>
If R1 is set to a non-zero value then <FONT COLOR="#004499"><B><I>PsiFS</I></B></FONT> does not wait for data to be flushed, so may result in data being lost. It should only be used as a last resort.
<P>
No action is taken if the block driver is already disabled.
</TD></TR>
</TABLE>
<HR>
<TABLE WIDTH="100%"><TR><TD COLSPAN=4 ALIGN=RIGHT><FONT COLOR="#DD0000"><TT><B>PsiFS_Mode 1</B></TT><BR><TT>(SWI&nbsp;&amp;520C4)</TT></FONT></TD></TR><TR VALIGN=TOP><TD></TD><TD COLSPAN=3>Set <FONT COLOR="#004499"><B><I>PsiFS</I></B></FONT> to remote link mode</TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>On&nbsp;entry:</B></FONT></TD><TD>R0&nbsp;=</TD><TD COLSPAN=2>1</TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>On&nbsp;exit:</B></FONT></TD><TD COLSPAN=3>Registers preserved</TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>Use:</B></FONT></TD><TD COLSPAN=3>
This call activates the configured block driver and attempts to initiate a connection to a remote <I>SIBO</I> or <I>EPOC</I> device using <I>Psion&nbsp;Link&nbsp;Protocol</I>. It is equivalent to using <TT>*<A HREF="../command/enabl.html" TITLE="*PsiFSEnable">PsiFSEnable</A></TT> with the <TT>-link</TT> switch.
<P>
If the block driver is already enabled then either no action is taken or an error is generated depending on whether the remote link is the current mode.
</TD></TR>
</TABLE>
<HR>
<TABLE WIDTH="100%"><TR><TD COLSPAN=4 ALIGN=RIGHT><FONT COLOR="#DD0000"><TT><B>PsiFS_Mode 2</B></TT><BR><TT>(SWI&nbsp;&amp;520C4)</TT></FONT></TD></TR><TR VALIGN=TOP><TD></TD><TD COLSPAN=3>Set <FONT COLOR="#004499"><B><I>PsiFS</I></B></FONT> to printer mirror mode</TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>On&nbsp;entry:</B></FONT></TD><TD>R0&nbsp;=</TD><TD COLSPAN=2>2</TD></TR>
<TR VALIGN=TOP><TD></TD><TD>R1&nbsp;=</TD><TD COLSPAN=2>control-terminated device name (0 for default)</TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>On&nbsp;exit:</B></FONT></TD><TD COLSPAN=3>Registers preserved</TD></TR>
<TR VALIGN=TOP><TD COLSPAN=4><BR></TD></TR><TR VALIGN=TOP><TD NOWRAP><FONT COLOR="#DD0000"><B>Use:</B></FONT></TD><TD COLSPAN=3>
This call activates the configured block driver and starts copying any characters received over the serial link to the device specified by R1. Any valid file or output device may be specified. The default is to use <TT>printer:</TT> which allows a <I>SIBO</I> or <I>EPOC</I> device to print to the active <I>RISC&nbsp;OS</I> printer without needing a special cable. It is equivalent to using <TT>*<A HREF="../command/enabl.html" TITLE="*PsiFSEnable">PsiFSEnable</A></TT> with the <TT>-print</TT> switch.
<P>
If the block driver is already enabled then either no action is taken or an error is generated depending on whether the printer mirror is the current mode.
</TD></TR>
</TABLE>
<HR> <TABLE WIDTH="100%">
<TR VALIGN=TOP>
<TD>
[<A HREF="../index.html" TITLE="Contents">Contents</A>]
[<A HREF="index.html" TITLE="Up">Up</A>]
</TD>
<TD ALIGN=RIGHT>
<FONT SIZE=-1><I> <A HREF="../legal/copy.html" TITLE="Copyright">Copyright</A> &copy; <A HREF="mailto:psifs@thouky.co.uk" TITLE="Send Email to Alexander Thoukydides">Alexander Thoukydides</A>, 1998, 1999, 2000, 2001, 2002</I></FONT>
</TD>
</TR>
</TABLE>
</BODY>
</HTML>
